apiVersion: apps/v1
kind: Deployment
metadata:
  name: redisinsight
  namespace: dpsrv
spec:
  replicas: 1
  selector:
    matchLabels:
      app: redisinsight
  template:
    metadata:
      labels:
        app: redisinsight
    spec:
      nodeSelector:
        DPSRV_REGION: cnt-use1
      enableServiceLinks: false
      containers:
        - name: redisinsight
          image: redislabs/redisinsight:2.70.1
          ports:
            - containerPort: 5540
          env:
            - name: DEBUG
              value: "api:*,db:*,redis-client:*"
            - name: REDIS_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: redis-ri-redis-password 
                  key: redis-ri-redis-password 
            - name: REDISINSIGHT__CONNECTIONS
              value: |
                [
                  {
                    "name": "Redis",
                    "connectionType": "SENTINEL",
                    "sentinelMaster": {
                      "name": "mymaster"
                    },
                    "sentinelEndpoints": [
                      { "host": "redis", "port": 26379 }
                    ],
                    "password": "${REDIS_PASSWORD:-}"
                  }
                ]

          #resources:
            #requests:
              #cpu: "100m"
              #memory: "256Mi"
            #limits:
              #cpu: "500m"
              #memory: "512Mi"

